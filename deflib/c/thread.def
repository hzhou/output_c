subcode: _autoload
    $include pthread
    $uselib pthread

subcode: run_threads(num_threads, param)
    $function thread_fn(void* p)
        $return_type void*
        BLOCK
        return NULL

    $global pthread_t p_threads[1000]
    $for i=0:$(num_threads)
        tn_ret = pthread_create(&p_threads[i], NULL, $(lambda), (void*)$(param))
        $if tn_ret
            $call die, "Error - pthread_create - $i"
    $for i=0:$(num_threads)
        pthread_join(p_threads[i], NULL)

    subcode: get_param(v)
        $local $(v)
        $get_type(T) $(v)
        $(v) = *(($(T)*)p)

